{% extends 'base.html' %}
{% block content %}
{% load static%}

<head> 
    <link rel="stylesheet" href="{% static 'feedpage/show.css' %}">
</head>

<div class="info">
    <div class = "title-div">
        <div class = "title-text" >{{ board_name }} 게시판 </div>
        <div>
            <a id="not_best" href="{% url 'showboard' board category %}">전체글</a>
        </div>
        <div id="best" style="color:#7f7f7f;">베스트</div>

            <!-- 전체글을 보는 게시판은 글쓰기 불가능하게! -->
            {% if board == "freeboard" or board_name != "전체" %}
                <div class = "write">
                    <a class = "write-button" href="{% url 'newfeed' board category %}">글쓰기</a>
                </div>
            {% endif %}
    </div>

    <div class = "index-div">
        {% if board_name == "전체" and board != "freeboard"%}
            <div class = "i-board">게시판</div>
        {% elif board == 'life' %}
            <div class = "i-board i-status">상태</div> 
        {% endif %}
        <div class = "i-title">제목</div>
        <div class = "i-author">작성자</div> 
        <div class = "i-date">날짜</div> 
        <div class = "i-views">조회수</div> 
        <div class = "i-likes">추천수</div> 
    </div> 

    <div class = "just-content">
    <!-- All 리스트 -->
        <div id="show_normal_lists" >
            {% for feed in posts %}
                <!-- 공지사항 list  -->
                {% if feed.notice %}
                    <a href="{% url 'showfeed' board category feed.id %}">
                        <div class = "whole-feed" style="background-color: #f9f9f9;">
                            {% if board_name == "전체" and board != "freeboard"%}
                                <div class="board_name"> 
                                    {% if board == "minwon" %}
                                        <div>{{ feed.board_info1 }}</div> <!-- 공통|학부|대학원|가족|BK -->
                                        <div>{{ feed.board_info2 }}</div>  <!-- 906동 -->
                                    {% elif board == 'life' %}  
                                        <div>{{ feed.board_info2 }}</div>  <!-- 공구|대여|보관|중고 -->
                                    {% endif %}
                                </div>
                            {% endif %}

                            <div class="feed-p">
                                <div class = "title-comment">
                                    <div class = "title" maxlength="20" text-overflow:ellipsis;> {{feed.title|truncatechars:25}} </div> 
                                        <div class = "comment" > {{ feed.feedcomment_set.count }} 공지 </div>
                                </div>
                                <div class = "content" style="color:gray" maxlength="30" text-overflow:ellipsis;>
                                    {{ feed.content|truncatechars:35 }}
                                </div> 
                            </div>
                        </div>
                    </a> 
                {% endif %}
            {% endfor %}

            <!-- 공지사항 아닌 Feed List -->
            {% for feed in posts %} 
                {% if not feed.notice  %}
                    <div class = "one-feed">
                        <a href="{% url 'showfeed' board category feed.id %}">
                            <div class = "whole-feed">
                                {% if board_name == "전체" and board != "freeboard"%}
                                    <div class="board_name"> 
                                        {% if board == "minwon" %}
                                            <div>{{ feed.board_info1 }}</div> <!-- 공통|학부|대학원|가족|BK -->
                                            <div>{{ feed.board_info2 }}</div>  <!-- 906동 -->
                                        {% elif board == "life" %}  
                                            <div>{{ feed.board_info2 }}</div>  <!-- 공구|대여|보관|중고 -->
                                            <div class = "life-status">
                                                <div class = "status-text"> {{ feed.status.1 }} </div> <!-- 진행중|판매중|마감 -->   
                                            </div>      
                                        {% endif %}
                                    </div>
                                {% elif board == "life" %} 
                                    <div class = "life-status">
                                        <div class = "status-text"> {{ feed.status.1 }} </div>
                                    </div>       
                                {% endif %}

                                <div class = "feed-p">
                                    <div class = "title-comment">
                                        <div class = "title" maxlength="20" text-overflow:ellipsis;> {{feed.title|truncatechars:25}} </div> 
                                        <div class = "comment" > {{ feed.feedcomment_set.count }} </div>
                                    </div>
                                    <div class = "content" text-overflow:ellipsis; >
                                        {{ feed.content|truncatechars:35 }}
                                    </div> 
                                </div>

                                <div class = "feed-a"> 
                                    {% if feed.noname %} 익명 
                                    {% else %} {{ feed.author.profile.nickname }}
                                    {% endif %}
                                </div> 

                                <div class = "date">{{ feed.created_at|date:"y.m.d" }}</div> 
                                <div class = "views">{{ feed.views }}</div>
                                <div class = "likes">{{ feed.like_users.count }}</div>
                            </div>
                        </a>
                    </div>
                {% endif %}
            {% endfor %} 

            <div class = "below">
                <div class="search">
                    <form class = "search-form" action="{% url 'showmain' %}" method="get">
                        <div class = "search-text">
                            <select class="search-option" name="select-option" style = "color: #7f7f7f;">
                                <option value="default">선택</option>
                                <option value="title">제목</option>
                                <option value="content">내용</option>
                                <option value="title-and-content">제목+내용</option>
                            </select>
                            <input type="text" class = "search-text" size ="30" placeholder = "검색어를 입력하세요.">
                        </div>
                    </form>
                </div>

                 
                    <!-- 전체글을 보는 게시판은 글쓰기 불가능하게! -->
                    {% if board == "freeboard" or board_name != "전체" %}
                        <div class = "write2">
                            <a class = "write-button" href="{% url 'newfeed' board category %}">글쓰기</a>
                        </div>
                    {% endif %}
                
            </div>

            <div class="page_numbers" >
                {% if posts.has_previous %}
                    <div class = "previous">
                        <a href="?page={{posts.previous_page_number}}"> 이전 </a>
                    </div> 
                {% endif %}
                {% for num in posts.paginator.page_range %} 
                    {% comment %} {% if num - 5 > posts.number and num - 5 < posts.number  %} {% endcomment %}
                        {% if posts.number == num %}
                            <div class = "num1" >{{ num }}</div> 
                        {% else %}
                            <div class = "num2" >{{ num }}</div>
                        {% endif %}
                    {% comment %} {% endif %} {% endcomment %}
                {% endfor %}
                {% comment %} <span>{{posts.paginator.num_pages}}</span>  {% endcomment %}
                {% if posts.has_next %}
                    <div class = "next">
                        <a href="?page={{posts.next_page_number}}"> 다음</a> 
                    </div>
                {% endif %}
            </div> 
        </div>

        <!-- 베스트 게시판 글 리스트: 베스트 버튼 -->
        <div id="show_best_lists"> 
            {% for feed in best_posts %}  
            <!-- 공지사항 list  -->
                {% if feed.notice %}
                    <a href="{% url 'showfeed' board category feed.id %}">
                        <div class = "whole-feed" style="background-color: #f9f9f9;">
                            {% if board_name == "전체" and board != "freeboard"%}
                                <div class="board_name" style="display:flex; flex-direction:column;"> 
                                    {% if board == "minwon" %}
                                        <div>{{ feed.board_info1 }}</div> <!-- 공통|학부|대학원|가족|BK -->
                                        <div>{{ feed.board_info2 }}</div>  <!-- 906동 -->
                                    {% elif board == 'life' %}  
                                        <div>{{ feed.board_info2 }}</div>  <!-- 공구|대여|보관|중고 -->
                                    {% endif %}
                                </div>
                            {% endif %}

                            <div class="feed-p">
                                <div class = "title-comment">
                                    <div class = "title" maxlength="20" text-overflow:ellipsis;> {{feed.title|truncatechars:25}} </div> 
                                    <div class = "comment" > {{ feed.feedcomment_set.count }} 공지 </div>
                                </div>
                                <div class = "content" style="color:gray" maxlength="30" text-overflow:ellipsis;>
                                    {{ feed.content|truncatechars:35 }}
                                </div> 
                            </div>
                        </div>
                    </a> 
                {% endif %}
            {% endfor %}

            <!-- 공지사항 아닌 Feed List -->
            {% for feed in best_posts %} 
                {% if feed.notice == False %}
                    <div class = "one-feed">
                        <a href="{% url 'showfeed' board category feed.id %}">
                            <div class = "whole-feed" >
                                <!-- 게시판 항목 이름 -->
                                {% if board_name == "전체" and board != "freeboard"%}
                                    <div class="board_name" style="display:flex; flex-direction:column;"> 
                                        {% if board == "minwon" %}
                                            <div>{{ feed.board_info1 }}</div> <!-- 공통|학부|대학원|가족|BK -->
                                            <div>{{ feed.board_info2 }}</div>  <!-- 906동 -->
                                        {% elif board == 'life' %}  
                                            <div>{{ feed.board_info2 }}</div>  <!-- 공구|대여|보관|중고 -->
                                            <div class = "life-status">
                                                <div class = "status-text"> {{ feed.status.1 }} </div> <!-- 진행중|판매중|마감 -->   
                                            </div>        
                                        {% endif %}
                                    </div>
                                {% elif board == "life" %} 
                                    <div class = "life-status">
                                        <div class = "status-text"> {{ feed.status.1 }} </div>
                                    </div>       
                                {% endif %}

                                <div class = "feed-p">
                                    <div class = "title-comment">
                                        <div maxlength="20" text-overflow:ellipsis;> {{ feed.title|truncatechars:25 }} </div> 
                                        <div class = "comment"> {{ feed.feedcomment_set.count }} </div>
                                    </div>
                                    <div class = "content" text-overflow:ellipsis;>
                                        {{ feed.content|truncatechars:35 }}
                                    </div> 
                                </div>

                                <div class = "feed-a"> 
                                    {% if feed.noname %} 익명 
                                    {% else %} {{ feed.author.profile.nickname }}
                                    {% endif %}
                                </div> 

                                <div class = "date">{{ feed.created_at|date:"y.m.d" }}</div> 
                                <div class = "views">{{ feed.views }}</div>
                                <div class = "likes">{{ feed.like_users.count }}</div>
                            </div>
                        </a>
                    </div>
                {% endif %}
            {% endfor %}

            <div class = "below">
                <div class="search">
                    <form class = "search-form" action="{% url 'showmain' %}" method="get">
                        <div class = "search-text">
                            <select class="search-option" name="select-option" style = "color: #7f7f7f;">
                                <option value="default">선택</option>
                                <option value="title">제목</option>
                                <option value="content">내용</option>
                                <option value="title-and-content">재목+내용</option>
                            </select>
                            <input type="text" class = "search-text" size ="30" placeholder = "검색어를 입력하세요.">
                        </div>
                    </form>
                </div>

                {% if board == "freeboard" or board_name != "전체" %}
                    <div class = "write2">
                        <a class = "write-button" href="{% url 'newfeed' board category %}">글쓰기</a>
                    </div>
                {% endif %}
            </div>

            <div class="page_numbers">
                {% if best_posts.has_previous %}
                    <div class = "previous">
                        <a href="?best_page={{best_posts.previous_page_number}}">이전</a> 
                    </div>
                {% endif %}
                {% for num in best_posts.paginator.page_range %} 
                        {% if best_posts.number == num %}
                            <div class = "num3">{{ num }}</div> 
                        {% else %}
                            <div class = "num4">{{ num }}</div>
                        {% endif %}
                {% endfor %}
                {% comment %} <span>{{posts.paginator.num_pages}}</span>  {% endcomment %}
                {% if best_posts.has_next %}
                    <div class ="next">
                        <a href="?best_page={{best_posts.next_page_number}}"> 다음</a>
                    </div>
                {% endif %}
            </div> 
        </div>
    </div>
</div>
<script src="{% static 'feedpage/showboard.js' %}"></script>
{% endblock content %}